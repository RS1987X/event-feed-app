version: 1
defaults:
  min_amount_ccy: SEK
  company_tier_weights: { "mega": 1.0, "large": 0.8, "mid": 0.6, "small": 0.4 }
  source_weights: { "exchange": 1.0, "issuer_pr": 0.8, "regulator": 1.0, "wire": 0.6 }

events:
  - key: guidance_change
    label: Guidance change for company or competitor

    thresholds:
      withdraw_or_suspend: always
      initiate_new_period: always
      delta_pct_level_min: 5        # revenue/EBIT/EBITDA in currency
      delta_pp_growth_min: 3        # growth % move in pp
      delta_pp_margin_min: 1.5      # margin % move in pp
      label_delta_pct_level_min: 2
      label_delta_pp_growth_min: 1.0
      label_delta_pp_margin_min: 0.3
      approx_band_pp_margin: 0.5
      approx_band_pp_growth: 1.0
      proximity:
        mode: "token"               # "char" | "token" | "both" | "either"
        fwd_cue_metric_chars: 120   # kept for back-compat / either/both mode
        fwd_cue_metric_tokens: 25   # token window for cue↔metric proximity
        allow_cross_sentence: false
        look_left_sentences: 0
        look_right_sentences: 0

    patterns:
      triggers:
        en_any:
          # Strong verbs near guidance/outlook/forecast
          - '\b(raise|raises|raised|raising|lower|lowers|lowered|lowering|revise|revises|revised|revising|update|updates|updated|updating|withdraw|withdraws|withdrew|withdrawn|suspend|suspends|suspended|suspending|reaffirm|reaffirms|reaffirmed|reaffirming|narrow|narrows|narrowed|narrowing|tighten|tightens|tightened|tightening|widen|widens|widened|widening)\b.{0,40}\b(guidance|outlook|forecast)s?\b'
          - '\b(guidance|outlook|forecast)s?\b.{0,40}\b(raise|raises|raised|raising|lower|lowers|lowered|lowering|revise|revises|revised|revising|update|updates|updated|updating|withdraw|withdraws|withdrew|withdrawn|suspend|suspends|suspended|suspending|reaffirm|reaffirms|reaffirmed|reaffirming|narrow|narrows|narrowed|narrowing|tighten|tightens|tightened|tightening|widen|widens|widened|widening)\b'
          # Profit warnings / alerts
          - '\bprofit\s+(warning|alert)s?\b'
          # Impairments / write-downs / write-offs
          - '\b(write[ -]?down|write[ -]?off|impairment(?:\s+charge)?s?)\b'
          # If you insist on "increase", use a tight window instead of 40 chars:
          # - '\b(increase|increases|increased|increasing)\b.{0,12}\b(guidance|outlook|forecast)s?\b'
          # - '\b(guidance|outlook|forecast)s?\b.{0,12}\b(increase|increases|increased|increasing)\b'

        sv_any:
          - '\b(höjer|höjde|höjs|sänker|sänkte|sänks|reviderar|reviderades?|uppdaterar|uppdaterades?|återkallar|drar\s+tillbaka|suspenderar|bekräftar|lämnar)\b.{0,40}\b(prognos(en)?|utsikter(na)?)\b'
          - '\b(prognos(en)?|utsikter(na)?)\b.{0,40}\b(höjs?|sänks?|revideras|uppdateras|återkallas|suspenderas|bekräftas|lämnas)\b'
          - '\bomvänd\s+vinstvarning\b|\bvinstvarning\b'
          - '\b(nedskrivning(ar)?|nedskrivnings(post|kostnad)(er)?|engångsnedskrivning(ar)?)\b'

      # NEW: forward-looking cue words/phrases (broad, used with proximity)
      fwd_cue:
        en_any:
          - '\b(expect|expects|project|projects|aim|target|targets|anticipate|plan|intend|will|should|we\s+(?:see|believe|expect))\b'
        sv_any:
          - '\b(förväntar|räknar\s+med|siktar|målsätter|planerar|avser|kommer\s+att|bör|vi\s+ser|vi\s+tror)\b'

      dir_up:
        any:
          - '\b(improv\w+|increase\w*|expand\w*|grow\w*|strengthen\w*|better)\b'
          - '\b(förbättra\w*|öka\w*|stärk\w*|bättre)\b'

      dir_dn:
        any:
          - '\b(declin\w+|decreas\w+|contract\w*|pressure|pressures|headwind\w*|worse)\b'
          - '\b(försämr\w*|minsk\w*|press|motvind\w*|sämre)\b'

      invite:
        any:
          - '\b(invite|invitation|invites|inbjudan|webcast|conference\s+call|earnings\s+call|teleconference|presentation|fireside\s+chat|reminder|save\s+the\s+date)\b'

      disclaimer_block:
        any:
          - '(forward[-\s]looking\s+statements|safe\s+harbor|cautionary\s+statement|legal\s+disclaimer|risk\s+factors|note\s+regarding\s+forward[-\s]looking)'

      disclaimer_inline:
        any:
          - '(statements?\s+that\s+are\s+not\s+historical|subject\s+to\s+risks\s+and\s+uncertainties|actual\s+results\s+may\s+differ\s+materially)'
      
      suppressors:
        analyst:
          any:
            - '\banalyst(s)?\b|\bconsensus\b|\bBloomberg\b|\bFactSet\b|\bInfront\b|\bRefinitiv(e)?\b'
        macro:
          any:
            - '\b(market|industry|sector|bransch|marknaden|industrin)\b'
        ma:
          any:
            - '\b(acquir(e|es|ed|ing)|acquisition|purchase price|consideration|enterprise value|EV|offer|bid|tender|förvärv|köpeskilling|vederlag|bud)\b'
        debt:
          any:
            - '\b(notes?|coupon|bond|loan|interest|facility|revolver|obligation|kupong|ränta|lån|kreditfacilitet)\b'

    # Optional: hot-tunable term lists for textutils proximity/direction
    terms:
      margin_allowed_prefixes:
        - operating
        - op.
        - EBIT
        - EBITDA
        - EBITA
        - rörelse
        - ebit
        - ebitda
        - ebita
        
      fwd_cue_terms:
        - expect
        - expects
        - project
        - aim
        - target
        - anticipate
        - we see
        - we believe
        - will
        - should
        - förväntar
        - räknar med
        - siktar
        - målsätter
        - kommer att
        - bör
        - vi ser
        - vi tror
      dir_up_terms:
        - improve
        - improving
        - increase
        - increasing
        - expand
        - grow
        - strengthen
        - better
        - förbättra
        - förbättras
        - öka
        - ökande
        - stärka
        - bättre
      dir_dn_terms:
        - decline
        - declining
        - decrease
        - decreasing
        - contract
        - pressure
        - headwinds
        - worse
        - försämra
        - försämras
        - minska
        - minskande
        - press
        - motvind
        - sämre


  - key: equity_raise
    label: Equity raise
    thresholds:
      amount_ccy: 50000000         # >= 50M SEK
    patterns:
      any: ["företrädesemission", "riktad emission", "new share issue", "private placement", "prospekt"]
    score:
      base: 0.65
      features: ["amount_log", "source_weight", "novelty_30d"]

  - key: ceo_change
    label: CEO change
    thresholds: {}
    patterns:
      any: ["CEO", "vd", "verkställande direktör", "chief executive"]
    score:
      base: 0.6
      features: ["source_weight", "company_tier"]

  - key: regulatory_approval
    label: Regulatory approval/clearance/refusal
    thresholds: {}
    patterns:
      any: ["approved", "clearance", "godkänd", "CE mark", "CRL", "refusal", "återkallelse", "recall"]
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: breaking_bond_covenants
    label: Breaking of bond covenants or loan agreements
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  
  - key: regulatory_resulution
    label: Investigations are closed with resolution (fine, warning, no action)
    thresholds: {}
    patterns:
      any: ["approved", "clearance", "godkänd", "CE mark", "CRL", "refusal", "återkallelse", "recall"]
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]


  - key: phase_3_clinical_trial_results
    label: Phase 3 clinical trial results
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: last_day_trading_of_rights
    label: Last day that rights are traded in rights issue, if stock was preassured from rights selling
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: incentive_program_expiration_upcoming
    label: Incentive programs expiring in next 3 months can lead to positive (possibly negative) communication
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: supplier_shortage
    label: Shortage at a supplier might lead to supply chain issues
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: distributor_inventory_build
    label: Inventory build up at distributor might lead to future sales drop
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]
            
  - key: major_product_recall
    label: companies recalling a major product might increase cost and drop sales and also lawsuits
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]
  
  - key: factory_shutdown
    label: Shutdown of capacity from accidents or other reasons leads might lead to supply issues
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: top_tier_partnerships
    label: Unproven company/product recognition by a top tier partnership
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]
  
  - key: major_order_win
    label: Major order win from established top tier customer
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]
      
  - key: competitor_tender_offer
    label: A competitor recieves tender offer for entire business
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: lawsuit_filed
    label: A regulator starts investigation or a lawsuit is filed against the company
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: large_share_buyback_program
    label: A large share buyback program might support the share price. Needs to be a fresh initiation or an acceleration.
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]

  - key: tending_period_expires
    label: Tendering period expires might be higher risk for the share if not 90% is reached
    thresholds: {}
    patterns:
      any: []
    score:
      base: 0.7
      features: ["source_weight", "corroboration_count"]
